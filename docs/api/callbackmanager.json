{
  "name": "CallbackManager",
  "module": "ai_infra.callbacks",
  "docstring": "Manages multiple callback handlers.\n\nDispatches events to all registered callbacks. Errors in callbacks\nare caught and logged, not propagated.\n\nExample:\n    manager = CallbackManager([\n        LoggingCallbacks(),\n        MetricsCallbacks(),\n    ])\n\n    # Fire event\n    manager.on_llm_start(LLMStartEvent(...))\n\n    # Or use context manager for timing\n    with manager.llm_call(\"openai\", \"gpt-4o\", messages) as ctx:\n        response = await do_llm_call()\n        ctx.set_response(response, tokens=150)",
  "parameters": [
    {
      "name": "callbacks",
      "type": "Sequence[Callbacks] | None",
      "default": "None",
      "description": "List of callback handlers (errors logged but not propagated)",
      "required": false
    },
    {
      "name": "critical_callbacks",
      "type": "Sequence[Callbacks] | None",
      "default": "None",
      "description": "List of critical callback handlers (errors propagate). Use for security audit callbacks that MUST succeed.",
      "required": false
    }
  ],
  "methods": [
    {
      "name": "__init__",
      "signature": "(callbacks: Sequence[Callbacks] | None = None, critical_callbacks: Sequence[Callbacks] | None = None)",
      "docstring": "Initialize CallbackManager.\n\nArgs:\n    callbacks: List of callback handlers (errors logged but not propagated)\n    critical_callbacks: List of critical callback handlers (errors propagate).\n        Use for security audit callbacks that MUST succeed.",
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "callbacks",
          "type": "Sequence[Callbacks] | None",
          "default": "None",
          "description": "List of callback handlers (errors logged but not propagated)",
          "required": false
        },
        {
          "name": "critical_callbacks",
          "type": "Sequence[Callbacks] | None",
          "default": "None",
          "description": "List of critical callback handlers (errors propagate). Use for security audit callbacks that MUST succeed.",
          "required": false
        }
      ],
      "returns": null,
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "add",
      "signature": "(callback: Callbacks, critical: bool = False) -> None",
      "docstring": "Add a callback handler.\n\nArgs:\n    callback: Callback handler to add\n    critical: If True, errors in this callback will propagate (not swallowed)",
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "callback",
          "type": "Callbacks",
          "default": null,
          "description": "Callback handler to add",
          "required": true
        },
        {
          "name": "critical",
          "type": "bool",
          "default": "False",
          "description": "If True, errors in this callback will propagate (not swallowed)",
          "required": false
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "llm_call",
      "signature": "(provider: str, model: str, messages: list[dict[str, Any]], extra: Any = {}) -> LLMCallContext",
      "docstring": "Context manager for LLM calls with auto-timing.",
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "provider",
          "type": "str",
          "default": null,
          "description": null,
          "required": true
        },
        {
          "name": "model",
          "type": "str",
          "default": null,
          "description": null,
          "required": true
        },
        {
          "name": "messages",
          "type": "list[dict[str, Any]]",
          "default": null,
          "description": null,
          "required": true
        },
        {
          "name": "extra",
          "type": "Any",
          "default": "{}",
          "description": null,
          "required": false
        }
      ],
      "returns": "LLMCallContext",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_graph_node_end",
      "signature": "(event: GraphNodeEndEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "GraphNodeEndEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_graph_node_error",
      "signature": "(event: GraphNodeErrorEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "GraphNodeErrorEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_graph_node_start",
      "signature": "(event: GraphNodeStartEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "GraphNodeStartEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_end",
      "signature": "(event: LLMEndEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMEndEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_end_async",
      "signature": "(event: LLMEndEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMEndEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_error",
      "signature": "(event: LLMErrorEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMErrorEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_error_async",
      "signature": "(event: LLMErrorEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMErrorEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_start",
      "signature": "(event: LLMStartEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMStartEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_start_async",
      "signature": "(event: LLMStartEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMStartEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_token",
      "signature": "(event: LLMTokenEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMTokenEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_llm_token_async",
      "signature": "(event: LLMTokenEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "LLMTokenEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_mcp_connect",
      "signature": "(event: MCPConnectEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "MCPConnectEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_mcp_disconnect",
      "signature": "(event: MCPDisconnectEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "MCPDisconnectEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_mcp_logging",
      "signature": "(event: MCPLoggingEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "MCPLoggingEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_mcp_logging_async",
      "signature": "(event: MCPLoggingEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "MCPLoggingEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_mcp_progress",
      "signature": "(event: MCPProgressEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "MCPProgressEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_mcp_progress_async",
      "signature": "(event: MCPProgressEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "MCPProgressEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_tool_end",
      "signature": "(event: ToolEndEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "ToolEndEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_tool_end_async",
      "signature": "(event: ToolEndEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "ToolEndEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_tool_error",
      "signature": "(event: ToolErrorEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "ToolErrorEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_tool_error_async",
      "signature": "(event: ToolErrorEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "ToolErrorEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_tool_start",
      "signature": "(event: ToolStartEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "ToolStartEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "on_tool_start_async",
      "signature": "(event: ToolStartEvent) -> None",
      "docstring": null,
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "event",
          "type": "ToolStartEvent",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": true,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "remove",
      "signature": "(callback: Callbacks) -> None",
      "docstring": "Remove a callback handler.",
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "callback",
          "type": "Callbacks",
          "default": null,
          "description": null,
          "required": true
        }
      ],
      "returns": "None",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    },
    {
      "name": "tool_call",
      "signature": "(tool_name: str, arguments: dict[str, Any], server_name: str | None = None, extra: Any = {}) -> ToolCallContext",
      "docstring": "Context manager for tool calls with auto-timing.",
      "parameters": [
        {
          "name": "self",
          "type": null,
          "default": null,
          "description": null,
          "required": false
        },
        {
          "name": "tool_name",
          "type": "str",
          "default": null,
          "description": null,
          "required": true
        },
        {
          "name": "arguments",
          "type": "dict[str, Any]",
          "default": null,
          "description": null,
          "required": true
        },
        {
          "name": "server_name",
          "type": "str | None",
          "default": "None",
          "description": null,
          "required": false
        },
        {
          "name": "extra",
          "type": "Any",
          "default": "{}",
          "description": null,
          "required": false
        }
      ],
      "returns": "ToolCallContext",
      "is_async": false,
      "is_classmethod": false,
      "is_staticmethod": false,
      "is_property": false,
      "raises": null
    }
  ],
  "bases": [],
  "source_file": "src/ai_infra/callbacks.py",
  "source_line": 407
}
